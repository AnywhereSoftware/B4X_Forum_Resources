### [Server] Using Let's Encrypt on Ubuntu VPS by aeric
### 10/30/2020
[B4X Forum - B4J - Tutorials](https://www.b4x.com/android/forum/threads/124059/)

[SPOILER="Intro"]  
So I have created a few [**JRDC2**](https://www.b4x.com/android/forum/threads/b4x-jrdc2-b4j-implementation-of-rdc-remote-database-connector.61801/) apps. I put them on a [**VPS**](https://www.b4x.com/android/forum/threads/server-run-a-server-on-a-vps.60378/) as live demo. It is running on Ubuntu 18.04 64 bit. Today I wanted to make the app more secure by [**enabling SSL certificate**](https://www.b4x.com/android/forum/threads/server-ssl-connections.40130/). I have chosen to use Let's Encrypt. There are many tutorials here but I am confused with the steps. Especially for people who are not familiar with Linux path and commands.  
The steps explained in <http://wiki.eclipse.org/Jetty/Howto/Configure_SSL#Generating_Keys_and_Certificates_with_JDK_keytool> (updated link:[**Generating Key Pairs and Certificates**](http://www.eclipse.org/jetty/documentation/current/configuring-ssl.html#generating-key-pairs-and-certificates)) is confusing and I have read many times tried to understand which parts are required. After spending a few hours, I have finally able to put all the puzzles together.  
  
To summarize what I have learned,   
I can enable SSL (or https in the URL) in my app without purchasing an SSL certificate (since my app is for demo/testing purpose and not considered critical). Let's Encrypt is a popular choice. I found it is easy to install on Ubuntu. Once installed, my website is now SSL enabled (served by Apache on port 80).  
[/SPOILER]  
  
**#1 [How to: Install Let's Encrypt on Ubuntu Linux VPS to Create SSL Certificates](https://help.skysilk.com/support/solutions/articles/9000139836-how-to-install-let-s-encrypt-on-ubuntu-linux-vps-to-create-ssl-certificates)  
  
Downloading and Installing Let's Encrypt  
1**. Update the server's packages  

```B4X
apt-get update & sudo apt-get upgrade
```

  
**2**. Install the GIT package  

```B4X
apt-get install git
```

  
**3**. Download a clone of Let's Encrypt from the GitHub repository to **/opt**  

```B4X
git clone https://github.com/letsencrypt/letsencrypt /opt/letsencrypt
```

  
**4**. Navigate to the new **/opt/letsencrypt** directory  

```B4X
cd /opt/letsencrypt
```

  
**Creating an SSL Certificate  
1**. Run Let's Encrypt (api.puterise.com is my domain)\*   

```B4X
./letsencrypt-auto certonly â€“standalone -d api.puterise.com
```

  
**2**. Follow the steps  
**3**. Agree to the Terms of Service  
**4**. If everything worked properly, you should receive a message similar to the following  
> IMPORTANT NOTES:   
> - If you lose your account credentials, you can recover them through e-mails sent to [email]somebody@example.com[/email].   
> - Congratulations! Your certificate and chain have been saved at /etc/letsencrypt/live/[api.puterise.com/fullchain.pem](http://api.puterise.com/fullchain.pem). Your cert will expire on 2021-01-31. To obtain a new version of the certificate in the future, simply run Let's Encrypt again.   
> - Your account credentials have been saved in your Let's Encrypt configuration directory at /etc/letsencrypt. You should make a secure backup of this folder now. This configuration directory will also contain certificates and private keys obtained by Let's Encrypt, so making regular backups of this folder is ideal.   
> - If you like Let's Encrypt, please consider supporting our work by   
> Donating to ISRG / Let's Encrypt: <https://letsencrypt.org/donate>   
> Donating to EFF: <https://eff.org/donate-le>

  
  
Now, to make it work on B4J JRDC2 app:  
  
**#2**  [**How to use Letsencrypt certificate & private key with Jetty (xkr47/letsencrypt-jetty.sh)**](https://gist.github.com/xkr47/920ffe94f6a4c171ee59)  
  

```B4X
root@computer:/etc/letsencrypt/live/api.puterise.com# openssl pkcs12 -export -out keystore.pkcs12 -in fullchain.pem -inkey privkey.pem
```

  

```B4X
root@computer:/etc/letsencrypt/live/api.puterise.com# keytool -importkeystore -srckeystore keystore.pkcs12 -srcstoretype PKCS12 -destkeystore keystore.jks
```

  

```B4X
root@computer:/etc/letsencrypt/live/api.puterise.com# rm keystore.pkcs12
```

  
Enter and verify the source and destination password.  
  
![](https://www.b4x.com/android/forum/attachments/102254)  
Now I can use the keystore file in [**B4J server code**](https://www.b4x.com/android/forum/threads/server-ssl-connections.40130/).  

```B4X
ssl.SetKeyStorePath("/etc/letsencrypt/live/api.puterise.com", "keystore.jks") 'path to keystore file
```

  
  
  
Conclusion:  
The above steps explained how I can enable SSL in hosted VPS server with certificates already generated by Let's Encrypt.   
For local development machine, it is easier to follow the steps to generate the **keystore file** from **[Generating Key Pairs and Certificates](http://www.eclipse.org/jetty/documentation/current/configuring-ssl.html#generating-key-pairs-and-certificates).**  
  
![](https://www.b4x.com/android/forum/attachments/102256)  
  

```B4X
#If RELEASE  
ssl.SetKeyStorePath("/etc/letsencrypt/live/api.puterise.com", "keystore.jks") 'path to keystore file  
#Else  
ssl.SetKeyStorePath("C:\SSL", "jetty.keystore") 'path to keystore file  
#End If
```