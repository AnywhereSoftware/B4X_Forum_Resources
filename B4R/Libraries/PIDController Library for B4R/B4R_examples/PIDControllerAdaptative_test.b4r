Build1=Default,B4RDev
Group=Default Group
Library1=rcore
Library2=resp8266wifi
Library3=rpidcontroller
NumberOfFiles=0
NumberOfLibraries=3
NumberOfModules=0
Version=4
@EndOfDesignText@

#Region Project Attributes
	#AutoFlushLogs: True
	#CheckArrayBounds: True
	#StackBufferSize: 600
#End Region
'Ctrl+Click to open the C code folder: ide://run?File=%WINDIR%\System32\explorer.exe&Args=%PROJECT%\Objects\Src

Sub Process_Globals
	Public Serial1 As Serial
	Private wifi As ESP8266WiFi 
	Private pinInput0 As Pin
	Private pidController As PIDController
	Private Conservative As PIDParameters
	Private Aggresive As PIDParameters
	Private Adaptative As PIDParametersAdaptative
	Private ConservativeID As ULong
	Private AggresiveID As ULong
	Private AdaptativeID As ULong
End Sub

Private Sub AppStart
	Serial1.Initialize(115200)
	Log("AppStart")
	'example of connecting to a local network
	If wifi.Connect2("SSID", "PASSWORD") Then
		Log("Connected to network")
	Else
		Log("Failed to connect to network")
	End If
	pinInput0.Initialize(0, pinInput0.MODE_INPUT)
	ConservativeID = Conservative.Initialize(1.0, 0.05, 0.25)
	AggresiveID = Aggresive.Initialize(4.0, 0.2, 1)
	AdaptativeID = Adaptative.Initialize(10, ConservativeID, 100, AggresiveID)
	pidController.Initialize(AggresiveID, pidController.DIRECTION_DIRECT)
	
	pidController.Input =  pinInput0.AnalogRead
	pidController.Setpoint = 100
	pidController.TurnOn(True)
	AddLooper("localLoop")
End Sub

Sub LocalLoop
	pidController.Input = 0

	Dim gap As Double = Abs(pidController.GetError)
	Dim parameterID As ULong = Adaptative.GetAt(gap)
	pidController.SetTunings(parameterID)

	pidController.Update()
End Sub


